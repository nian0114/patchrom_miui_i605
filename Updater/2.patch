From 4e7531f5ca418b3d101cd715b9724ce11df01962 Mon Sep 17 00:00:00 2001
From: X-s <xsmumu@gmail.com>
Date: Mon, 15 Jun 2015 21:48:58 +0800
Subject: [PATCH] add juelian smali

---
 .../smali/com/android/updater/JuelianUtils$1.smali |  67 ++++++
 .../smali/com/android/updater/JuelianUtils$2.smali |  50 ++++
 .../smali/com/android/updater/JuelianUtils.smali   | 252 +++++++++++++++++++++
 3 files changed, 369 insertions(+)
 create mode 100644 Updater/smali/com/android/updater/JuelianUtils$1.smali
 create mode 100644 Updater/smali/com/android/updater/JuelianUtils$2.smali
 create mode 100644 Updater/smali/com/android/updater/JuelianUtils.smali

--- a/Updater/smali/com/android/updater/JuelianUtils$1.smali
+++ b/Updater/smali/com/android/updater/JuelianUtils$1.smali
@@ -0,0 +1,63 @@
+.class Lcom/android/updater/JuelianUtils$1;
+.super Ljava/lang/Object;
+.source "JuelianUtils.java"
+
+# interfaces
+.implements Ljava/lang/Runnable;
+
+
+# annotations
+.annotation system Ldalvik/annotation/EnclosingMethod;
+    value = Lcom/android/updater/JuelianUtils;->setPostUrl()V
+.end annotation
+
+.annotation system Ldalvik/annotation/InnerClass;
+    accessFlags = 0x0
+    name = null
+.end annotation
+
+
+# instance fields
+.field final synthetic this$0:Lcom/android/updater/JuelianUtils;
+
+
+# direct methods
+.method constructor <init>(Lcom/android/updater/JuelianUtils;)V
+    .locals 0
+
+    .prologue
+    iput-object p1, p0, Lcom/android/updater/JuelianUtils$1;->this$0:Lcom/android/updater/JuelianUtils;
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public run()V
+    .locals 2
+
+    .prologue
+    iget-object v0, p0, Lcom/android/updater/JuelianUtils$1;->this$0:Lcom/android/updater/JuelianUtils;
+
+    # getter for: Lcom/android/updater/JuelianUtils;->mWebView:Landroid/webkit/WebView;
+    invoke-static {v0}, Lcom/android/updater/JuelianUtils;->access$0(Lcom/android/updater/JuelianUtils;)Landroid/webkit/WebView;
+
+    move-result-object v0
+
+    iget-object v1, p0, Lcom/android/updater/JuelianUtils$1;->this$0:Lcom/android/updater/JuelianUtils;
+
+    # getter for: Lcom/android/updater/JuelianUtils;->mVersion:Ljava/lang/String;
+    invoke-static {v1}, Lcom/android/updater/JuelianUtils;->access$1(Lcom/android/updater/JuelianUtils;)Ljava/lang/String;
+
+    move-result-object v1
+
+    invoke-static {v1}, Lcom/android/updater/JuelianUtils;->getNewVersionUrl(Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v1
+
+    invoke-virtual {v0, v1}, Landroid/webkit/WebView;->loadUrl(Ljava/lang/String;)V
+
+    return-void
+.end method
--- a/Updater/smali/com/android/updater/JuelianUtils$2.smali
+++ b/Updater/smali/com/android/updater/JuelianUtils$2.smali
@@ -0,0 +1,46 @@
+.class Lcom/android/updater/JuelianUtils$2;
+.super Landroid/webkit/WebViewClient;
+.source "JuelianUtils.java"
+
+
+# annotations
+.annotation system Ldalvik/annotation/EnclosingMethod;
+    value = Lcom/android/updater/JuelianUtils;->setWebViewClient()V
+.end annotation
+
+.annotation system Ldalvik/annotation/InnerClass;
+    accessFlags = 0x0
+    name = null
+.end annotation
+
+
+# instance fields
+.field final synthetic this$0:Lcom/android/updater/JuelianUtils;
+
+
+# direct methods
+.method constructor <init>(Lcom/android/updater/JuelianUtils;)V
+    .locals 0
+
+    .prologue
+    iput-object p1, p0, Lcom/android/updater/JuelianUtils$2;->this$0:Lcom/android/updater/JuelianUtils;
+
+    invoke-direct {p0}, Landroid/webkit/WebViewClient;-><init>()V
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public shouldOverrideUrlLoading(Landroid/webkit/WebView;Ljava/lang/String;)Z
+    .locals 1
+    .param p1, "view"    # Landroid/webkit/WebView;
+    .param p2, "url"    # Ljava/lang/String;
+
+    .prologue
+    invoke-virtual {p1, p2}, Landroid/webkit/WebView;->loadUrl(Ljava/lang/String;)V
+
+    const/4 v0, 0x1
+
+    return v0
+.end method
--- a/Updater/smali/com/android/updater/JuelianUtils.smali
+++ b/Updater/smali/com/android/updater/JuelianUtils.smali
@@ -0,0 +1,233 @@
+.class public Lcom/android/updater/JuelianUtils;
+.super Ljava/lang/Object;
+.source "JuelianUtils.java"
+
+
+# static fields
+.field private static ftpPath:Ljava/lang/String;
+
+
+# instance fields
+.field private mVersion:Ljava/lang/String;
+
+.field private mWebView:Landroid/webkit/WebView;
+
+
+# direct methods
+.method static constructor <clinit>()V
+    .locals 1
+
+    .prologue
+    const-string v0, "mijl.changelog.ftpPath"
+
+    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v0
+
+    sput-object v0, Lcom/android/updater/JuelianUtils;->ftpPath:Ljava/lang/String;
+
+    return-void
+.end method
+
+.method public constructor <init>(Landroid/webkit/WebView;Ljava/lang/String;)V
+    .locals 0
+    .param p1, "view"    # Landroid/webkit/WebView;
+    .param p2, "version"    # Ljava/lang/String;
+
+    .prologue
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    iput-object p1, p0, Lcom/android/updater/JuelianUtils;->mWebView:Landroid/webkit/WebView;
+
+    iput-object p2, p0, Lcom/android/updater/JuelianUtils;->mVersion:Ljava/lang/String;
+
+    invoke-virtual {p0}, Lcom/android/updater/JuelianUtils;->setPostUrl()V
+
+    invoke-virtual {p0}, Lcom/android/updater/JuelianUtils;->setWebViewClient()V
+
+    return-void
+.end method
+
+.method static synthetic access$0(Lcom/android/updater/JuelianUtils;)Landroid/webkit/WebView;
+    .locals 1
+
+    .prologue
+    iget-object v0, p0, Lcom/android/updater/JuelianUtils;->mWebView:Landroid/webkit/WebView;
+
+    return-object v0
+.end method
+
+.method static synthetic access$1(Lcom/android/updater/JuelianUtils;)Ljava/lang/String;
+    .locals 1
+
+    .prologue
+    iget-object v0, p0, Lcom/android/updater/JuelianUtils;->mVersion:Ljava/lang/String;
+
+    return-object v0
+.end method
+
+.method public static getNewVersionUrl(Ljava/lang/String;)Ljava/lang/String;
+    .locals 4
+    .param p0, "newVersion"    # Ljava/lang/String;
+
+    .prologue
+    new-instance v1, Ljava/lang/StringBuilder;
+
+    sget-object v2, Lcom/android/updater/JuelianUtils;->ftpPath:Ljava/lang/String;
+
+    invoke-static {v2}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    const-string v2, "ro.product.mod_device"
+
+    invoke-static {v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    const-string v2, "_"
+
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    const-string v2, ".html"
+
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v0
+
+    .local v0, "str":Ljava/lang/String;
+    const-string v1, "mijl-->"
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string v3, "new url:"
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v2
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-static {v1, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    return-object v0
+.end method
+
+.method public static getOldVersionUrl(Ljava/lang/String;)Ljava/lang/String;
+    .locals 4
+    .param p0, "oldVersion"    # Ljava/lang/String;
+
+    .prologue
+    new-instance v1, Ljava/lang/StringBuilder;
+
+    sget-object v2, Lcom/android/updater/JuelianUtils;->ftpPath:Ljava/lang/String;
+
+    invoke-static {v2}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    const-string v2, "ro.product.mod_device"
+
+    invoke-static {v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    const-string v2, "_"
+
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    const-string v2, ".html"
+
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v0
+
+    .local v0, "str":Ljava/lang/String;
+    const-string v1, "mijl-->"
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string v3, "old url:"
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v2
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-static {v1, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    return-object v0
+.end method
+
+
+# virtual methods
+.method public setPostUrl()V
+    .locals 2
+
+    .prologue
+    iget-object v0, p0, Lcom/android/updater/JuelianUtils;->mWebView:Landroid/webkit/WebView;
+
+    new-instance v1, Lcom/android/updater/JuelianUtils$1;
+
+    invoke-direct {v1, p0}, Lcom/android/updater/JuelianUtils$1;-><init>(Lcom/android/updater/JuelianUtils;)V
+
+    invoke-virtual {v0, v1}, Landroid/webkit/WebView;->post(Ljava/lang/Runnable;)Z
+
+    return-void
+.end method
+
+.method public setWebViewClient()V
+    .locals 2
+
+    .prologue
+    iget-object v0, p0, Lcom/android/updater/JuelianUtils;->mWebView:Landroid/webkit/WebView;
+
+    new-instance v1, Lcom/android/updater/JuelianUtils$2;
+
+    invoke-direct {v1, p0}, Lcom/android/updater/JuelianUtils$2;-><init>(Lcom/android/updater/JuelianUtils;)V
+
+    invoke-virtual {v0, v1}, Landroid/webkit/WebView;->setWebViewClient(Landroid/webkit/WebViewClient;)V
+
+    return-void
+.end method
-- 
1.9.1


